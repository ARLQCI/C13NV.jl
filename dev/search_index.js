var documenterSearchIndex = {"docs":
[{"location":"references/#References","page":"References","title":"References","text":"A.Â Ajoy, K.Â Liu, R.Â Nazaryan, X.Â Lv, P.Â R.Â Zangara, B.Â Safvati, G.Â Wang, D.Â Arnold, G.Â Li, A.Â Lin, P.Â Raghavan, E.Â Druga, S.Â Dhomkar, D.Â Pagliero, J.Â A.Â Reimer, D.Â Suter, C.Â A.Â Meriles and A.Â Pines. Orientation-independent room temperature optical ^13C hyperpolarization in powdered diamond. Sci.Â Adv. 4 (2018).\n\n\n\nM.Â H.Â Goerz. The Hamiltonian for 1000 carbon atoms surrounding an NV center. MultiCarbon.jl Pluto notebook in 2025-02_C13_Polarization_Hamiltonian (2025).\n\n\n\nM.Â H.Â Goerz. Performing the RWA on the electronic spin system. RWA_electronic_spin_system.jl Pluto notebook in 2025-02_C13_Polarization_Hamiltonian (2025).\n\n\n\nM.Â H.Â Goerz. The Hamiltonian of the \"Â¹Â³C hyperpolarization in diamond\" paper (2025).\n\n\n\nM.Â H.Â Goerz. Diagonalizing the Hyperfine Interaction. DiagonalizeHyperfine.jl Pluto notebook in 2025-02_C13_Polarization_Hamiltonian (2025).\n\n\n\nM.Â H.Â Goerz. Review of Landau Zener Transitions. LandauZener.jl Pluto notebook in 2025-02-04_Landau_Zener (2025).\n\n\n\nM.Â H.Â Goerz, D.Â M.Â Reich and C.Â P.Â Koch. Optimal control theory for a unitary operation under dissipative evolution, arXiv:1312.0111v2 (2013).\n\n\n\n","category":"section"},{"location":"api/#API","page":"API","title":"API","text":"","category":"section"},{"location":"api/#Index","page":"API","title":"Index","text":"","category":"section"},{"location":"api/#Reference","page":"API","title":"Reference","text":"","category":"section"},{"location":"api/#C13NV.Models.ket-Tuple{Any, Any}","page":"API","title":"C13NV.Models.ket","text":"Construct an eigenstate\n\nÎ¨ = ket(label, labels; strict = true)\n\nconstructs the canonical basis state identified by label in a Hilbert space with a basis defined by labels. If label is not an element of labels, return a zero-vector if strict = false, and error if strict = true (default). The use of strict = false can be useful when working in a truncated Hilbert space.\n\n\n\n\n\n","category":"method"},{"location":"api/#C13NV.Models.make_nv_system-Tuple{}","page":"API","title":"C13NV.Models.make_nv_system","text":"Construct the system.\n\nH_or_L, labels = make_nv_system(; kwargs...)\n\nreturn a generator, and a list of labels, each label a tuple of strings.\n\nKeyword Arguments\n\nhyperfine_tensors: Required if A_zz, A_zx, A_zy are not given. A vector of 3Ã—3  matrices. The number length of the vector, i.e., the number of matrices given determines the number of C-13 atoms in the model. Defaults to a single hyperfine tensor with elements A_zz, A_zx, A_zy.\nA_zz, A_zx, A_zy: Required if hyperfine_tensors is not given, the strength of the hyperfine coupling along the 3 spatial axes relevant in the RWA, for a single C-13 atom.\nB: Required. The magnitude of the magnetic field\nÏ‰â‚Š = nothing: The control Ï‰_+(t)  Ï•_+(t)t\nÏ‰â‚‹ = nothing: The control Ï‰_-(t)  Ï•_-(t)t\nÎ©â‚Š = nothing: The control Î©_+(t)\nÎ©â‚‹ = nothing: The control Î©_-(t)\nÎ› = nothing: The time-dependent optical drive. If given, implies the use of the full optical Hilbert space.\nframe = :rwa: One of :rwa or :diag. If :diag, diagonalize the hyperfine interaction.\nÎ¸ = 0.0: The azimuthal angle of the magnetic field\nÏ• = 0.0: The polar angle of the magnetic field\nÎ³_c = 1.07kHz/Gauss: The C-13 nuclear gyromagnetic ratio\nÎ´â‚‹ = 0.0: The detuning of the 0  -1 transition. Defined as Î´_- = D - B Î³_e cos(Î¸) - Ï‰-\nÎ´â‚Š = 0.0: The detuning of the 0  +1 transition. Defined as Î´_+ = D - B Î³_e cos(Î¸) - Ï‰+\nÎ“ = 0.0: Rate for the E  G spontaneous decay\nÎ“â‚€ = 0.0: Rate for the E0  M spontaneous decay\nÎ“â‚Šâ‚ = 0.0: Rate for the E+1  M spontaneous decay\nÎ“â‚‹â‚ = 0.0: Rate for the E-1  M spontaneous decay\nÎ£â‚€ = 0.0: Rate for the M  G0 spontaneous decay\nÎ£â‚Šâ‚ = 0.0: Rate for the M  G+1 spontaneous decay\nÎ£â‚‹â‚ = 0.0: Rate for the M  G-1 spontaneous decay\nÎ³â‚Šâ‚ = 0.0: Rate for the G+1  G0 spontaneous decay\nÎ³â‚‹â‚ = 0.0: Rate for the G-1  G0 spontaneous decay\n\n\n\n\n\n","category":"method"},{"location":"api/#C13NV.Defaults.with_defaults-Tuple{}","page":"API","title":"C13NV.Defaults.with_defaults","text":"Combine keyword arguments with default values\n\nkwargs = with_defaults(;\n    A_zz = 1.0MHz,\n    A_zx = 0.3MHz,\n    B = 120Gauss,\n    Î³_c = 1.07kHz/Gauss,\n    Î´â‚‹ = 0.0,\n    Î´â‚Š = 0.0,\n    Î“ = (1 / (12ns)),\n    Î“â‚€ = 0.0,\n    Î“â‚Šâ‚ = (1 / (24ns + 0.9ns)),\n    Î“â‚‹â‚ = (1 / (24ns + 0.9ns)),\n    Î£â‚€ = (1 / (219ns)),\n    Î£â‚Šâ‚ = (1 / (219ns)),\n    Î£â‚‹â‚ = (1 / (219ns)),\n)\n\naccepts the keyword arguments for numerical parameter (floating point values) in C13NV.Models.make_nv_system and assigns default parameters for any value not given.\n\n\n\n\n\n","category":"method"},{"location":"hamiltonian/#Generalized-Hamiltonian-for-multiple-C-atoms-around-an-NV-center","page":"Hamiltonian","title":"Generalized Hamiltonian for multiple Â¹Â³C atoms around an NV center","text":"For the purpose of implementing a very general numerical model of the interaction of the nuclear spin of one or more Â¹Â³C atoms with the electronic spin of a single NV center in diamond in a private C13NV Julia package, we extensively discuss the Hamiltonian and Liouvillian for the system in full generality. Within C13NV, the construction is encapsulated in a make_nv_system function, that receives various system parameters and returns a Hamiltonian or Liouvillian (a QuantumPropagators.Generators.Generator instance) along with a list of labels (each label is a tuple of strings).\n\nWe discuss first the high-level structure of the Hilbert space (Structure of the Hilbert space) and the Hamiltonian/Liouvillian (Structure of the Hamiltonian and Liouvillian) before deriving the operators in detail. Lab Frame Hamiltonian for the Ground State Manifold lists the lab frame Hamiltonian and defines the spin operators for the electronic and nuclear spins. Microwave Field Rotating Wave Approximation transforms the lab frame Hamiltonian into the rotating frame. This yields one possible Hamiltonian to use numerically (frame = :rwa). Diagonalizing the Hyperfine Interaction goes further by analytically diagonalizing the hyperfine interaction between the nuclear spin and the electronic spin of the NV center. This yields an alternative form of the Hamiltonian (frame = :diag), which allows for a better understanding of avoided Landau-Zener crossings, discussed in Mapping between Electronic and Nuclear Spins via Landau-Zener Crossings. Lastly, Dissipators for the Excited and Metastable Manifolds describes the Lindblad operators for the full dissipative model.","category":"section"},{"location":"hamiltonian/#Structure-of-the-Hilbert-space","page":"Hamiltonian","title":"Structure of the Hilbert space","text":"The optical Hilbert space is â„‹_O with levels G, E, M. The Hilbert space may be truncated to G if the parameter Î› representing Lambda(t) is passed as nothing. Note that Î› = 0.0 is possible to force inclusion of all optical levels.\nThe Hilbert space of the NV center electronic spin is â„‹_S with levels +1, 0, -1. The -1 level is truncated if the Î©â‚‹ parameter representing Omega_-(t) is given as nothing, and likewise for +1 and Î©â‚Š. Either Î©â‚Š or Î©â‚‹ can be passed as 0.0 to force inclusion of the level.\nThe nuclear spin of each surrounding C13 is a TLS with Hilbert space â„‹_I^(n) spanned by the states , . These get tensored into a 2^N-dimensional spin space â„‹_I = â„‹_I^(1) otimes dots otimes â„‹_I^(N); for N=2: , , , , etc., for larger N.\n\nThe structure of the full Hilbert space is a little bit tricky, since the meta-stable state M does not distinguish between different electronic-spin degrees of freedom, and thus the three Hilbert spaces are not simply tensored. Instead,\n\nbeginequationlabeleq-Hilbert-space-structure\n\nbeginsplit\nâ„‹\n= â„_G otimes â„‹_S otimes â„‹_I oplus  â„_E otimes â„‹_S otimes â„‹_I oplus  â„_M otimes â„‹_I\n= (â„_G oplus â„_E) otimes  â„‹_S otimes  â„‹_I oplus  â„_M otimes  â„‹_I\n= underbrace((â„_G oplus â„_E) otimes  â„‹_S oplus  â„_M)_equiv â„‹_OS  otimes  â„‹_I\nendsplit\n\nendequation\n\nwhere â„_G, â„_E, and â„_M are the (trivial) one-dimensional Hilbert spaces consisting only of the optical levels G, E, and M, respectively. â„‹_S is the Hilbert space of the electronic spin, spanned by the three levels +1, 0, -1 (or a truncation thereof). We may define â„‹_OS = ((â„_G oplus â„_E) otimes  â„‹_S  oplus  â„_M) in the third line of EquationÂ eqrefeq-Hilbert-space-structure as the combined Hilbert space for the optical and electronic-spin degree of freedom, with the basis G+1, G0, G-1, E+1, E0, E-1, M. The structure in lines 2 and 3 of EquationÂ eqrefeq-Hilbert-space-structure is particularly helpful for constructing the relevant Lindblad operators in the full (optical) system.","category":"section"},{"location":"hamiltonian/#Structure-of-the-Hamiltonian-and-Liouvillian","page":"Hamiltonian","title":"Structure of the Hamiltonian and Liouvillian","text":"The transitions in the electronic spin states of the NV center +1, 0, -1 in â„‹_S are driven by a microwave (MW) field\n\nbeginequationlabeleq-combined-mw-field\n\nfrac1sqrt2 Omega(t) =\n    Omega_-(t) cos(omega_- t + phi_-(t))\n    + Omega_+(t) cos(omega_+ t + phi_+(t))\n\nendequation\n\nwhere the factor frac1sqrt2 is to compensate for the normalization factor in the hatS_x operator, see below in Lab Frame Hamiltonian for the Ground State Manifold. In a two-color rotating frame for the central frequencies omega_pm, this results in four independent control fields:\n\nomega_-(t) equiv fracdphi_-(t)dt, the deviation (dynamic shift) from the central frequency omega_-. Note that we use both the time-dependent omega_-(t) and the time-independent omega_- with different meanings.\nomega_+(t) equiv fracdphi_+(t)dt, the deviation (dynamic shift) from the central frequency omega_+\nOmega_-(t), the envelope for the amplitude driving the -1 leftrightarrow 0 transition\nOmega_+(t), the envelope for the amplitude driving the 0 leftrightarrow +1 transition\n\nWithin the QuantumControl.jl framework, the system Hamiltonian is expressed in the nested-list format\n\nbeginequationlabeleq-nested-list\n\nhatH = hatH_0 hatH_omega_- omega_-(t) hatH_omega_+ omega_+(t) hatH_Omega_- Omega_-(t) hatH_Omega_+ Omega_+(t)\n\nendequation\n\nwith the drift Hamiltonian hatH_0, the control Hamiltonians hatH_omega_-, hatH_omega_+, hatH_Omega_-, and hatH_Omega_+, and the controls listed above.\n\nConstruction of the Hamiltonian proceeds as follows:\n\nConstruct spin operators for the appropriately truncated Hilbert space â„‹_S, as well as â„‹_I^(n)\nConstruct the parts of EquationÂ eqrefeq-combined-mw-field in â„‹_S otimes â„‹_I according to EquationÂ eqrefeq-rwa-hamiltonian-nested-list if frame = :rwa, see Microwave Field Rotating Wave Approximation, or EquationÂ eqrefeq-hamiltonian-diagonal-nested-list if frame = :diag, see Diagonalizing the Hyperfine Interaction\nIf the full optical Hilbert space â„‹_O is required (Î› is given), extend each operator into the full â„‹ according to\nbeginequationlabeleq-hamiltonian-extension\nhatH_n rightarrow (ðŸ™_G otimes hatH_n) oplus underbrace(ðŸ™_E otimes ðŸ˜_S otimes ðŸ˜_I) oplus (ðŸ™_M otimes ðŸ˜_I)_textpadding\nendequation\ncf. the first line of EquationÂ eqrefeq-Hilbert-space-structure, with the trivial ðŸ™_G =  ðŸ™_E  = ðŸ™_M = 1. That is, we are simply padding the Hamiltonian with zeros to reach the size of the full Hilbert space. The choice of ðŸ˜_S and ðŸ˜_I reflects the fact that there are no coherent dynamics in the E and M manifolds.\n\nThe make_nv_system function returns a Liouvillian if Î› is given, or if decay rates gamma_pm 1 for the spontaneous decay in the electronic spin levels is given with a decay rate  0. The incoherent drive with Î› is time-dependent, and must be set up specially, see Dissipators for the Excited and Metastable Manifolds for details.","category":"section"},{"location":"hamiltonian/#Lab-Frame-Hamiltonian-for-the-Ground-State-Manifold","page":"Hamiltonian","title":"Lab Frame Hamiltonian for the Ground State Manifold","text":"We are considering here the Hamiltonian of a single electronic spin described in the ground-state manifold G by the spin operators hatmathbfS = (hatS_x hatS_y hatS_z) and N nuclear spins described by hatmathbfI^(n) = (hatI^(n)_x hatI^(n)_y hatI^(n)_z), with the element A_ij^(n) of the hyperfine tensor giving the strength of the interaction between the j = xyz components of the n'th nuclear spin and the i = xyz component of the electronic spin. The full Hamiltonian has the form [1, 2],\n\nbeginequationlabeleq-lab-hamiltonian\n\nhatH_textlab = D hatS_z^2 - gamma_e mathbfB cdot hatmathbfS + sum_n=1^N left( sum_substackij=x y z A^(n)_ij (hatS_i otimes hatI^(n)_j) - gamma_c mathbfB cdot hatmathbfI^(n)\nright) + Omega(t) hatS_x\n\nendequation\n\nwith Omega(t) given by EquationÂ eqrefeq-combined-mw-field, the electronic spin energy D approx 3 GHz, the electron gyromagnetic ratio gamma_e = 2.8 MHz/G, the nuclear gyromagnetic ratio gamma_c = 1.07 kHz/G, and the hyperfine tensor A^(n) mediating the interaction between the n-th carbon nuclear spin and the electronic spin of the NV center. The spin operators for the electronic spin are those for a spin-1 particle, with quantum numbers (+1 0 -1), cf.Â the hatS_z operator:\n\n\nhatS_x = frac1sqrt2beginpmatrix\n    0  1  0 \n    1  0  1 \n    0  1  0\nendpmatrixquad\nhatS_y = frac1sqrt2beginpmatrix\n    0  -i   0 \n    i   0  -i \n    0   i   0\nendpmatrixquad\nhatS_z = beginpmatrix\n    1  0    0 \n    0  0    0 \n    0  0   -1\nendpmatrixquad\nðŸ™_S = beginpmatrix\n    1  0   0 \n    0  1   0 \n    0  0   1\nendpmatrix\n\n\nIf we are only going to drive one of the -1 leftrightarrow 0 or 0 leftrightarrow +1 transitions, we can simply truncate the Hilbert space by cutting the above matrices from 3 times 3 to 2 times 2.\n\nThe nuclear spin is spin-frac12, and thus,\n\nhatI_x^(n) = frac12beginpmatrix\n    0  1 \n    1  0\nendpmatrixqquad\nhatI_y^(n) = frac12beginpmatrix\n    0  -i \n    i   0\nendpmatrixqquad\nhatI_z^(n) = frac12beginpmatrix\n    1    0 \n    0   -1\nendpmatrixqquad\nðŸ™_I^(n) = beginpmatrix\n    1  0 \n    0  1\nendpmatrix\n\nwith eigenstates labeled  and .\n\nThe magnetic field vector is\n\nbeginequationlabeleq-magnetic-field-vector\n\nmathbfB = B beginpmatrix\n    sin(theta) cos(phi)\n    sin(theta) sin(phi)\n    cos(theta)\n    endpmatrix\n\nendequation\n\nwith the azimuthal angle theta, the polar angle phi, and the field-strength B. We will assume theta = 0, but there is no need to restrict a numerical model to a magnetic field not aligned with the z-axis defined by the NV center. In EquationÂ eqrefeq-lab-hamiltonian, operators are implicitly tensored with the identity operator of all other subspaces.","category":"section"},{"location":"hamiltonian/#Microwave-Field-Rotating-Wave-Approximation","page":"Hamiltonian","title":"Microwave Field Rotating Wave Approximation","text":"To simplify the numerical model, and to remove the fast oscillations omega_+ and omega_-, we transform the Hamiltonian to a rotating frame and apply the rotating wave approximation (RWA). The main result of this section is EquationÂ eqrefeq-rwa-hamiltonian.\n\nThe rotating frame is defined by the operator\n\nbeginequationlabeleq-U-RWA\n\nhatU_textRWA(t)\n= textdiagleft\nexpi omega_+ t + phi_+(t) quad\n1 quad\nexpi omega_- t + phi_-(t)\nright\n\nendequation\n\nin the electronic spin subspace. The wave function in the rotating frame is defined as kettildePsi(t) = hatU_textRWA(t) ketPsi(t). The Hamiltonian in the rotating frame is\n\nbeginequationlabeleq-H-RWA-general\n\nhatH_textRWA = i hbar dotU_textRWA hatU_textRWA^dagger + hatU_textRWA hatH_textlab hatU_textRWA^dagger\n\nendequation\n\nWe again have the implicit tensor product, i.e., in the full Hilbert space, EquationÂ eqrefeq-H-RWA-general is more properly written with hatU_textRWA rightarrow hatU_textRWA otimes ðŸ™_I. It is helpful to explicitly consider the transformation in the electronic-spin-subspace within this tensor structure. For the first term in EquationÂ eqrefeq-H-RWA-general,\n\nbeginequationlabeleq-RWA-term1\n\ni hbar left(fracpartialpartial t(hatU_textRWA otimes ðŸ™_I)right)left(hatU_textRWA otimes ðŸ™_I right)^dagger\n= (i hbar dotU_textRWA hatU_textRWA^dagger) otimes ðŸ™_I\n\nendequation\n\nFor the second term in EquationÂ eqrefeq-H-RWA-general, we observe that EquationÂ eqrefeq-lab-hamiltonian has the form\n\nbeginequationlabeleq-H-as-sum-over-k\n\nhatH_textlab = sum_k hatH_S^(k) otimes hatH_I^(k)\n\nendequation\n\nwhere k simply numbers the different terms, and hatH_S^(k) and hatH_I^(k) are operators in the electronic-spin and combined-nuclear-spins subspaces. Consequently,\n\nbeginequationlabeleq-RWA-term2\nbeginsplit\nleft(hatU_textRWA otimes ðŸ™_I right) hatH_textlab left(hatU_textRWA otimes ðŸ™_I right)^dagger\n=\nsum_k left(hatU_textRWA otimes ðŸ™_I right) left(hatH_S^(k) otimes hatH_I^(k)right)\nleft(hatU_textRWA otimes ðŸ™_I right)^dagger \n= sum_k hatU_textRWA hatH_S^(k) hatU_textRWA^dagger otimes hatH_I^(k)\nendsplit\nendequation\n\nIn both cases, we have made use of the distributive property of tensor and matrix products,\n\nbeginequationlabeleq-tensor-distributivity\n\n(hatA otimes hatB) (hatC otimes hatD)\n= hatA hatC otimes hatBhatD\n\nendequation\n\nWe can now apply this to the individual operators in EquationÂ eqrefeq-lab-hamiltonian, while also neglecting any fast-rotating terms propto exp(pm i omega_pmt) (or faster), with the resonance-condition\n\nbeginequationlabeleq-resonance-condition\n\nomega_pm = D - B gamma_e cos(theta) - delta_pm\nquadLeftrightarrowquad\ndelta_pm equiv D - B gamma_e cos(theta) - omega_pm\n\nendequation\n\nintroducing the detunings delta_+ and delta_-.\n\nOne remarkable finding that simplifies the structure of the resulting rotating wave Hamiltonian is that [3]\n\nbeginequationlabeleq-S-in-RWA\n\nhatU_textRWA hatS_xy hatU_textRWA^dagger\napprox 0qquad\nhatU_textRWA hatS_z hatU_textRWA^dagger = hatS_z\n\nendequation\n\nso that\n\nbeginequationlabeleq-hyperfine-RWA\n\nhatU_textRWA left( sum_substackij=x y z A^(n)_ij (hatS_i otimes hatI^(n)_j) right) hatU_textRWA^dagger\n= sum_substackj=x y z A_zj^(n) hatS_z otimes hatI_j^(n)\n= hatS_z otimes hatA_I^(n)\n\nendequation\n\nwith the hyperfine-projections\n\nbeginequationlabeleq-A-I-matrix\n\nhatA_I^(n)\n= sum_j A_zj^(n) hatI_j^(n)\n= frac12 beginpmatrix\n          A_zz^(n)  A_zx^(n) - i A_zy^(n) \n    A_zx^(n) + i A_zy^(n)        -A_zz^(n)\nendpmatrix\n\nendequation\n\nSimilarly, we can define\n\nbeginequationlabeleq-B-I-matrix\n\nhatB_I^(n)\n= mathbfB cdot hatmathbfI^(n)\n= fracB2 beginpmatrix\ncos(theta)  sin(theta)cos(phi) - i sin(theta)sin(phi)\nsin(theta)cos(phi) + i sin(theta)sin(phi)  -cos(theta)\nendpmatrix\n\nendequation\n\nGoing through all the terms in EquationÂ eqrefeq-lab-hamiltonian, we thus find\n\nbeginequationlabeleq-rwa-hamiltonian\n\nhatH_textRWA\n= (hatdelta - hatomega(t)) otimes ðŸ™_I + sum_n=1^N left(hatS_z otimes hatA_I^(n) - gamma_c ðŸ™_S otimes hatB_I^(n) right) + hatOmega(t) otimes ðŸ™_I\n\nendequation\n\nwith\n\n\nhatdelta = textdiagleftdelta_+ 0 delta_-rightquad\nhatomega(t) = textdiagleftdotphi_+(t) 0 dotphi_-(t)rightquad\nhatOmega(t) = frac12 beginpmatrix\n        0           Omega_+(t)       0         \n    Omega_+(t)       0           Omega_-(t) \n        0           Omega_-(t)        0\nendpmatrix\n\n\nFor the nested-list format in EquationÂ eqrefeq-nested-list, this means\n\nbeginequationlabeleq-rwa-hamiltonian-nested-list\n\nbeginsplit\nhatH_0 textRWA  = hatdelta otimes ðŸ™_I + sum_n=1^N left(hatS_z otimes hatA_I^(n) - gamma_c ðŸ™_S otimes hatB_I^(n) right) \nhatH_omega_- textRWA  = --1-1  otimes  ðŸ™_I \nhatH_omega_+ textRWA  = -+1+1  otimes  ðŸ™_I \nhatH_Omega_- textRWA  = frac12 left( 0-1 + -10 right) otimes ðŸ™_I \nhatH_Omega_+ textRWA  = frac12 left( 0+1 + +10 right) otimes ðŸ™_I\nendsplit\n\nendequation\n\nThese operators are all in â„‹_S otimes â„‹_I.","category":"section"},{"location":"hamiltonian/#Linear-Chirp-and-Single-Carbon","page":"Hamiltonian","title":"Linear Chirp and Single Carbon","text":"(Image: Ground state manifold energy levels)\n\nThe energy levels are depicted in the figure above, for the special case of a linear chirp,\n\nbeginequationlabeleq-linear-chirp\n\ndotphi_pm(t) = alpha_pm (t - t_pm)\n\nendequation\n\na single carbon atom in the z-x plane (A_zy = 0) and the B field aligned to the z axis (theta = phi = 0 in EquationÂ eqrefeq-magnetic-field-vector).\n\nIn explicit matrix form, the Hamiltonian for this special case in the subspace including the electronic spin 0 and the +1 subspace is [4]\n\nbeginequationlabeleq-hamiltonian-rwa-matrix-plus\n\nhatH_textRWA + = beginpmatrix\n    fracA_zz2 - fracB gamma_c2 - alpha_+(t - t_+) + delta_+  fracA_zx2  fracOmega_+(t)2  0 \n    fracA_zx2  -fracA_zz2 + fracB gamma_c2 - alpha_+ (t - t_+) + delta_+  0  fracOmega_+(t)2 \n    fracOmega_+(t)2  0  -fracB gamma_c2  0 \n    0  fracOmega_+(t)2  0  fracB gamma_c2\nendpmatrix\n\nendequation\n\nand, in the subspace with electronic spin 0 and -1,\n\nbeginequationlabeleq-hamiltonian-rwa-matrix-minus\n\nhatH_textRWA - = beginpmatrix\n    -fracB gamma_c2  0  fracOmega_-(t)2  0\n    0  fracB gamma_c2  0  fracOmega_-(t)2 \n    fracOmega_-(t)2  0  - fracA_zz2 - fracB gamma_c2 - alpha_-(t - t_-) + delta_-  fracA_zx2 \n    0  fracOmega_-(t)2  -fracA_zx2  fracA_zz2 + fracB gamma_c2 - alpha_- (t - t_-) + delta_- \nendpmatrix\n\nendequation\n\nNote the off-resonant Rabi-cycling in the  1 manifolds, cf.Â also EquationÂ eqrefeq-A-I-matrix.","category":"section"},{"location":"hamiltonian/#Diagonalizing-the-Hyperfine-Interaction","page":"Hamiltonian","title":"Diagonalizing the Hyperfine Interaction","text":"We can further simplify the Hamiltonian by diagonalizing the projection of the hyperfine matrix into the nuclear-spin subspace, EquationÂ eqrefeq-A-I-matrix. We note that hatA_I^(n) is Hermitian, and thus real-valued eigenvalues and a unitary transformation operator hatR^(n) so that\n\nbeginequationlabeleq-eigendecomposition\n\nhatA_I^(n)\n= hatR^(n)\n    beginpmatrix\n    lambda_+  0  0  lambda_-\n  endpmatrix\n  hatR^(n)dagger\n\nendequation\n\nThis eigendecomposition can be solved analytically [5] with\n\nbeginequationlabeleq-analytical-eigenvalues\n\nlambda_pm = fracoperatornametr(hatA_I^(n))2 pm sqrtfracoperatornametr^2(hatA_I^(n))4 - det(hatA_I^(n))\n\nendequation\n\nWe can see that\n\n\noperatornametr(hatA_I^(n)) = 0 qquad\ndet(hatA_I^(n)) = -frac14 A^(n)^2\n\n\nwith the overall hyperfine magnitude\n\nbeginequationlabeleq-A\n\nA^(n) equiv sqrtA_zz^(n)^2 + A_zx^(n)^2 + A_zy^(n)^2\n\nendequation\n\nThus, we have\n\nbeginequationlabeleq-lambda\n\nlambda_pm = pm A  2\n\nendequation\n\nand\n\nbeginequationlabeleq-eigendecomposition-A\n\nhatA_I^(n) = A  hatR^(n) hatI_z^(n) hatR^(n)dagger\n\nendequation\n\nFor R^(n), with proper normalization (R^(n) R^(n)^dagger = ðŸ™_I^(n)), we find (temporarily dropping the superscript (n) on the right-hand-side):\n\nbeginequationlabeleq-R\n\nhatR^(n) = frac1sqrt2 beginpmatrix\n\tfracA_zz + AsqrtA^2 + A A_zz  fracA_zz - AsqrtA^2 - A A_zz \n\tfracA_zx + i A_zysqrtA^2 + A A_zz  fracA_zx + i A_zysqrtA^2 - A A_zz\nendpmatrix\n\nendequation\n\nFor the total Hamiltonian, we can now define a diagonal frame via the unitary\n\nbeginequationlabeleq-R-total\n\nhatR = hatR^(1) otimes dots otimes hatR^(N)\n\nendequation\n\nThe Hamiltonian in this diagonal frame is\n\nbeginequationlabeleq-hamiltonian-diagonal\n\nbeginsplit\nhatH_textdiag\n = hatR^dagger hatH_textRWA hatR \n = (hatdelta - hatomega(t)) otimes ðŸ™_I + sum_n=1^N left(A^(n) hatS_z otimes hatI_z^(n) - gamma_c ðŸ™_S otimes hatB_I^(n) right) + hatOmega(t) otimes ðŸ™_I\nendsplit\n\nendequation\n\nwith hatB_I^(n) defined in EquationÂ eqrefeq-B-I-matrix. Any wave function kettildePsi(t) in the rotating frame is transformed into the diagonal frame as ketPsi(t) = hatR^dagger kettildePsi(t). Note the dagger, as we have used the common notation for the eigendecomposition in EquationÂ eqrefeq-eigendecomposition, which is the opposite from the notation used for the rotating frame, cf. EquationÂ eqrefeq-H-RWA-general. The transformation affects the relative population in the nuclear spins. In the diagonal frame, after Omega(t) has been switched off, the populations remain stable (since the Hamiltonian is diagonal). In contrast, in the lab/rotating frame, we would be seeing indefinite off-resonant Rabi-cycling in the ketpm 1 manifolds. The transformation hatR precisely restores the superposition due to this Rabi cycling.\n\nFor the nested-list format in EquationÂ eqrefeq-nested-list, this means\n\nbeginequationlabeleq-hamiltonian-diagonal-nested-list\n\nhatH_0 textdiag =  hatdelta otimes ðŸ™_I + sum_n=1^N left(A^(n) hatS_z otimes hatI_z^(n) - gamma_c ðŸ™_S otimes hatB_I^(n) right)\n\nendequation\n\nand hatH_omega_- textdiag hatH_omega_+ textdiag hatH_Omega_- textdiag hatH_Omega_+ textdiag as in EquationÂ eqrefeq-rwa-hamiltonian-nested-list; all operators in â„‹_S otimes â„‹_I. The only difference between the rotating frame Hamiltonian in EquationÂ eqrefeq-rwa-hamiltonian and the diagonal frame Hamiltonian is the term hatS_z otimes hatA_I^(n) in EquationÂ eqrefeq-rwa-hamiltonian and EquationÂ eqrefeq-rwa-hamiltonian-nested-list being replaced with A^(n) hatS_z otimes hatI_z^(n) in EquationÂ eqrefeq-hamiltonian-diagonal and EquationÂ eqrefeq-hamiltonian-diagonal-nested-list.","category":"section"},{"location":"hamiltonian/#Linear-Chirp-and-Single-Carbon-2","page":"Hamiltonian","title":"Linear Chirp and Single Carbon","text":"As we did in the rotating frame in EquationÂ eqrefeq-hamiltonian-rwa-matrix-plus and EquationÂ eqrefeq-hamiltonian-rwa-matrix-minus, we can again write out the Hamiltonian for the 0+1 and 0-1 manifolds under the assumption of a single nuclear spin and a linear chirp.\n\nbeginequationlabeleq-hamiltonian-diag-matrix-plus\n\nhatH_textRWA + = beginpmatrix\n    fracA2 - fracB gamma_c2 - alpha_+(t - t_+) + delta_+          0         fracOmega_+(t)2  0 \n            0         -fracA2 + fracB gamma_c2 - alpha_+ (t - t_+) + delta_+  0  fracOmega_+(t)2 \n    fracOmega_+(t)2  0  -fracB gamma_c2  0 \n    0  fracOmega_+(t)2  0  fracB gamma_c2\nendpmatrix\n\nendequation\n\nbeginequationlabeleq-hamiltonian-diag-matrix-minus\n\nhatH_textRWA - = beginpmatrix\n    -fracB gamma_c2  0  fracOmega_-(t)2  0\n    0  fracB gamma_c2  0  fracOmega_-(t)2 \n    fracOmega_-(t)2  0  - fracA2 - fracB gamma_c2 - alpha_-(t - t_-) + delta_-         0         \n    0  fracOmega_-(t)2          0          fracA2 + fracB gamma_c2 - alpha_- (t - t_-) + delta_- \nendpmatrix\n\nendequation\n\nwith the A given in EquationÂ eqrefeq-A.","category":"section"},{"location":"hamiltonian/#Mapping-between-Electronic-and-Nuclear-Spins-via-Landau-Zener-Crossings","page":"Hamiltonian","title":"Mapping between Electronic and Nuclear Spins via Landau-Zener Crossings","text":"TODO\n\nAfter a Landau-Zener transition, the probability of population transfer is [6]\n\nbeginequationlabeleq-lz-probability\n\nP_LZ = expleft(-2 pi fracvertOmegavert^2vertalphavert^2 right)\n\nendequation","category":"section"},{"location":"hamiltonian/#Dissipators-for-the-Excited-and-Metastable-Manifolds","page":"Hamiltonian","title":"Dissipators for the Excited and Metastable Manifolds","text":"(Image: Level scheme of the combined optical-electronic subspace)\n\nThe optical laser field Lambda(t) enables incoherent transitions between the ground state G manifold described above, and the excited state manifold E. We also have a decay channel from E to G via the metastable state M (frequently also indicated as S in the literature, but this might cause confusion), as depicted in the level scheme figure above.\n\nThe dynamics are described by a master equation in Lindblad form with the following Lindblad operators:\n\nhatA_Lambda = sqrtLambda(t) EG otimes ðŸ™_S otimes ðŸ™_I  oplus ðŸ˜_M otimes ðŸ™_I\nhatA_Gamma = sqrtGammaGE otimes ðŸ™_S otimes ðŸ™_I  oplus ðŸ˜_M otimes ðŸ™_I\n\nwhere EG and GE are operators in the two-dimensional Hilbert space â„_G oplus â„_E, cf.Â the second line in EquationÂ eqrefeq-Hilbert-space-structure. The first of the two Lindblad operators above describes the somewhat unusual incoherent excitation of the E manifold. The time-dependent Lambda(t) is not directly supported by the QuantumControl.liouvillian function. Instead, we construct a super-operator [7]\n\nbeginequationlabeleq-dissipation-superop\nL = (hatA^dagger)^T otimes hatA - frac12 left(ðŸ™ otimes hatA^dagger hatAright) - frac12 left((hatA^dagger hatA)^T otimes ðŸ™right)\nendequation\n\nwith hatA the operator hatA_Lambda for sqrtLambda(t) = 1 (i.e., without the rate factor). This is done by calling the QuantumControl.liouvillian function with nothing as the Hamiltonian and hatA as the only element in c_ops. The resulting L is then added with a drive Lambda(t) to the Liouvillian super-operator initialized automatically via the QuantumControl.liouvillian function from the coherent Hamiltonian previously constructed, the dissipator hatA_Gamma, and the following further dissipators:\n\nhatA_Gamma_0 = sqrtGamma_0ME0 otimes ðŸ™_I\nhatA_Gamma_-1 = sqrtGamma_-1ME-1 otimes ðŸ™_I\nhatA_Gamma_+1 = sqrtGamma_+1ME+1 otimes ðŸ™_I\nhatA_Sigma_0 = sqrtSigma_0G0M otimes ðŸ™_I\nhatA_Sigma_-1 = sqrtSigma_-1G-1M otimes ðŸ™_I\nhatA_Sigma_+1 = sqrtSigma_+1G+1M otimes ðŸ™_I\nhatA_gamma_+1 = sqrtgamma_+1G0G+1 otimes ðŸ™_I\nhatA_gamma_-1 = sqrtgamma_-1G0G-1 otimes ðŸ™_I\n\nThe last two operators are under the assumption that spontaneous decay of the electronic spin occurs only in the G manifold, as indicated in the level scheme figure above; if that decay also occurred in the E manifold, the corresponding terms E0braEpm1 would have to be added to hatA_gamma_pm1. All of the above decay operators follow the structure of the third line in EquationÂ eqrefeq-Hilbert-space-structure.","category":"section"},{"location":"#C13NV","page":"Home","title":"C13NV","text":"using Markdown\nusing Pkg\n\nVERSION = Pkg.dependencies()[Base.UUID(\"136d2b59-c380-4582-9748-dc44afbd1b80\")].version\n\ngithub_badge = \"[![Github](https://img.shields.io/badge/ARLQCI-C13NV.jl-blue.svg?logo=github)](https://github.com/ARLQCI/C13NV.jl)\"\n\nversion_badge = \"![v$VERSION](https://img.shields.io/badge/version-v$(replace(\"$VERSION\", \"-\" => \"--\"))-green.svg)\"\n\nMarkdown.parse(\"$github_badge $version_badge\")","category":"section"},{"location":"#Contents","page":"Home","title":"Contents","text":"Depth = 2\nPages = [pair[2] for pair in Main.PAGES[2:end-1]]","category":"section"}]
}
