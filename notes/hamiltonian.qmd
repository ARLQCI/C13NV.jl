---
author: Michael Goerz
date: today
date-format: long
title: 'Generalized Hamiltonian for multiple Â¹Â³C atoms around an NV center'
bibliography: refs.bib
csl: prl.csl
number-sections: true
link-citations: true
format:
  html:
    toc: false
    html-math-method: katex
    fontsize: 10pt
    echo: false
    filters:
        - expand_macros.lua
  pdf:
    keep-tex: true
    toc: false
    colorlinks: true
    fontsize: 10pt
    echo: false
    include-in-header:
      text: |
        \usepackage{braket}
        \usepackage{amsmath}
        \DeclareMathOperator{\tr}{tr}
        \DeclareMathOperator{\diag}{diag}
        \newcommand{\RWA}{\textrm{RWA}}
        \newcommand{\lab}{\textrm{lab}}
        \newcommand{\Hilbert}{\mathcal{H}}
        \newcommand{\HilbertS}{\mathcal{H}_{\!S}}
        \newcommand{\HilbertI}{\mathcal{H}_{\!I}}
        \newcommand{\HilbertGE}{\mathcal{H}_{\!GE}}
        \newcommand{\HilbertO}{\mathcal{H}_{\!O}}
        \newcommand{\HilbertOS}{\mathcal{H}_{\!OS}}
        \newcommand{\HilbertM}{\mathcal{I}_{\!M}}
        \newcommand{\HilbertG}{\mathcal{I}_{\!G}}
        \newcommand{\HilbertE}{\mathcal{I}_{\!E}}
        \newcommand{\ketbra}[2]{\ket{#1}\!\bra{#2}}
  docx:
    toc: false
    colorlinks: true
    fontsize: 10pt
    echo: false
    filters:
        - expand_macros.lua
---

For the purpose of implementing a very general numerical model of the interaction of the nuclear spin of one or more Â¹Â³C atoms with the electronic spin of a single NV center in diamond in a private `C13NV` Julia package, we extensively discuss the Hamiltonian and Liouvillian for the system in full generality. Within `C13NV`, the construction is encapsulated in a `make_nv_system` function, that receives various system parameters and returns a Hamiltonian or Liouvillian (a `QuantumPropagators.Generators.Generator` instance) along with a list of labels (each label a tuple of strings).

We discuss first the high-level structure of the Hilbert space (@sec-hilbert-structure) and the Hamiltonian/Liouvillian (@sec-hamiltonian-structure) before deriving the operators in detail. @sec-lab lists the lab frame Hamiltonian and defines the spin operators for the electronic and nuclear spins. @sec-rwa transforms the lab frame Hamiltonian into the rotating frame. This yields one possible Hamiltonian to use numerically (`frame = :rwa`). @sec-diag goes further by analytically diagonalizing the hyperfine interaction between the nuclear spin and the electronic spin of the NV center. This yields an alternative form the Hamiltonian (`frame = :diag`), which allows for a better understanding of avoided Landau-Zener crossings, discussed in @sec-lz. Lastly, @sec-dissipation describes the Lindblad operators for the full dissipative model.


## Structure of the Hilbert space {#sec-hilbert-structure}

* The optical Hilbert space is $\HilbertO$ with levels $\ket{G}$, $\ket{E}$, $\ket{M}$. The Hilbert space may be truncated to $\ket{G}$ is the parameter `Î›` representing $\Lambda(t)$ is passed as `nothing`. Note that `Î› = 0.0` is possible to force inclusion of all optical levels.
* The Hilbert space of the NV center electronic spin is $\HilbertS$ with levels $\ket{+1}$, $\ket{0}$, $\ket{-1}$. The $\ket{-1}$ level is truncated if the `Î©`$_{-}$ parameter representing $\Omega_{-}(t)$ is given as `nothing`, and likewise for $\ket{+1}$ and `Î©`$_{+}$. Either `Î©`$_{+}$ or `Î©`$_{-}$ can be passed as `0.0` to force inclusion of the level.
* The nuclear spin of each surrounding C13 is a TLS with Hilbert space $\HilbertI^{(n)}$ spanned by the states $\ket{\uparrow}$, $\ket{\downarrow}$. These get tensored into a $2^N$-dimensional spin space $\HilbertI = \HilbertI^{(1)} \otimes \dots \otimes \HilbertI^{(N)}$;
for $N=2$: $\ket{\uparrow\uparrow}$, $\ket{\uparrow\downarrow}$, $\ket{\downarrow\uparrow}$, $\ket{\downarrow\downarrow}$ etc. for larger $N$.

The structure of the full Hilbert space is a little bit tricky, since the meta-stable state $\ket{M}$ does not distinguish between different electronic-spin degrees of freedom, and thus the three Hilbert spaces are not simply tensored. Instead,

$$
\begin{split}
\Hilbert
&= \HilbertG \otimes \HilbertS \otimes \HilbertI \; \oplus \; \HilbertE \otimes \HilbertS \otimes \HilbertI  \; \oplus \; \HilbertM \otimes \HilbertI \\
&= (\HilbertG \oplus \HilbertE) \otimes \, \HilbertS \, \otimes \, \HilbertI \; \oplus \; \HilbertM \, \otimes \, \HilbertI \\
&= \underbrace{((\HilbertG \oplus \HilbertE) \otimes \, \HilbertS \, \oplus \, \HilbertM)}_{\equiv \HilbertOS} \, \otimes \, \HilbertI\,,
\end{split}
$$ {#eq-Hilbert-space-structure}

where $\HilbertG$, $\HilbertE$, and $\HilbertM$ are the (trivial) one-dimensional Hilbert spaces consisting only of the optical levels $\ket{G}$, $\ket{E}$, and $\ket{M}$, respectively. $\HilbertS$ is the Hilbert space of the electronic spin, spanned by the three levels $\ket{+1}$, $\ket{0}$, $\ket{-1}$ (or a truncation thereof). We may define
$\HilbertOS = ((\HilbertG \oplus \HilbertE) \otimes \, \HilbertS \, \oplus \, \HilbertM)$ in the third line of @eq-Hilbert-space-structure as the combined Hilbert space for the optical and electronic-spin degree of freedom, with the basis $\ket{G,+1}$, $\ket{G,0}$, $\ket{G,-1}$, $\ket{E,+1}$, $\ket{E,0}$, $\ket{E,-1}$, $\ket{M}$. The structure in lines 2 and 3 of @eq-Hilbert-space-structure is particularly helpful for constructing the relevant Lindblad operators in the full (optical) system.


## Structure of the Hamiltonian and Liouvillian {#sec-hamiltonian-structure}

The transitions in the electronic spin states of the NV center $\ket{+1}$, $\ket{0}$, $\ket{-1} \in \HilbertS$ are driven by a microwave (MW) field

$$
\frac{1}{\sqrt{2}} \Omega(t) =
    \Omega_{-}(t) \cos(\omega_{-} t + \phi_{-}(t))
    + \Omega_{+}(t) \cos(\omega_{+} t + \phi_{+}(t))\,,
$$ {#eq-combined-mw-field}

where the factor $\frac{1}{\sqrt{2}}$ is to compensate the normalization factor in the $\hat{S}_x$ operator, see below in @sec-lab. In a two-color rotating frame for the central frequencies $\omega_{\pm}$, this results in four independent control fields:

1. $\omega_{-}(t) \equiv \frac{d\phi_{-}(t)}{dt}$, the deviation (dynamic shift) from the central frequency $\omega_{-}$. Note that we use both the time-dependent $\omega_{-}(t)$ and the time-independent $\omega_{-}$ with different meanings.
2. $\omega_{+}(t) \equiv \frac{d\phi_{+}(t)}{dt}$, the deviation (dynamic shift) from the central frequency $\omega_{+}$
3. $\Omega_{-}(t)$, the envelope for the amplitude driving the $\ket{-1} \leftrightarrow \ket{0}$ transition
4. $\Omega_{+}(t)$, the envelope for the amplitude driving the $\ket{0} \leftrightarrow \ket{+1}$ transition

Within the `QuantumControl.jl` framework, the system Hamiltonian is expressed in the nested-list format

$$
\hat{H} = [\hat{H_0}, [\hat{H}_{\omega_{-}}, \omega_{-}(t)], [\hat{H}_{\omega_{+}}, \omega_{+}(t)], [\hat{H}_{\Omega_{-}}, \Omega_{-}(t)], [\hat{H}_{\Omega_{+}}, \Omega_{+}(t)]]
$$ {#eq-nested-list}

with the drift Hamiltonian $\hat{H_0}$, the control Hamiltonians $\hat{H}_{\omega_{-}}$, $\hat{H}_{\omega_{+}}$, $\hat{H}_{\Omega_{-}}$, and $\hat{H}_{\Omega_{+}}$, and the controls listed above.

Construction of the Hamiltonian proceeds as follows:

1. Construct spin operators for the appropriately truncated Hilbert space $\HilbertS$, as well as $\HilbertI^{(n)}$
2. Construct the parts of @eq-combined-mw-field $\in \HilbertS \otimes \HilbertI$ according to @eq-rwa-hamiltonian-nested-list if `frame = :rwa`, see @sec-rwa, or @eq-hamiltonian-diagonal-nested-list if `frame = :diag`, see @sec-diag
3. If the full optical Hilbert space $\HilbertO$ is required (`Î›` is given), extend each operator into the full $\Hilbert$ according to

   $$
   \hat{H}_{n} \rightarrow (ğŸ™_G \otimes \hat{H}_n) \,\oplus\, \underbrace{(ğŸ™_E \otimes ğŸ˜_S \otimes ğŸ˜_I) \,\oplus\, (ğŸ™_M \otimes ğŸ˜_I)}_{\text{padding}}
   $$ {#eq-hamiltonian-extension}

   cf. the first line of @eq-Hilbert-space-structure, with the trivial $ğŸ™_G =  ğŸ™_E  = ğŸ™_M = 1$. That is, we are simply padding the Hamiltonian with zeros to reach the size of the full Hilbert space. The choice of $ğŸ˜_S$ and $ğŸ˜_I$ reflects the fact that there are no coherent dynamics in the $\ket{E}$ and $\ket{M}$ manifolds.


The `make_nv_system` function returns a Liouvillian if `Î›` is given, or if decay rates $\gamma_{\pm 1}$ for the spontaneous decay in the electronic spin levels is given with a decay rate $> 0$. The incoherent drive with `Î›` is time-dependent, and must be set up specially, see @sec-dissipation for details.


## Lab Frame Hamiltonian for the Ground State Manifold {#sec-lab}

We are considering here the Hamiltonian of a single electronic spin described in the ground-state manifold $\ket{G}$ by the spin operators $\hat{\mathbf{S}} = (\hat{S}_x, \hat{S}_y, \hat{S}_z)$ and $N$ nuclear spins described by $\hat{\mathbf{I}}^{(n)} = (\hat{I}^{(n)}_x, \hat{I}^{(n)}_y, \hat{I}^{(n)}_z)$, with the element $A_{i,j}^{(n)}$ of the hyperfine tensor giving the strength of the interaction between the $j = x,y,z$ components of the $n$'th nuclear spin and the $i = x,y,z$ component of the electronic spin. The full Hamiltonian has the form [@AjoySA2018; @MultiCarbon.jl],

$$
\hat{H}_{\lab} = D \hat{S}_z^2 - \gamma_e \mathbf{B} \cdot \hat{\mathbf{S}} + \sum_{n=1}^{N} \left( \sum_{\substack{i,j\\=x, y, z}} A^{(n)}_{i,j} (\hat{S}_i \otimes \hat{I}^{(n)}_j) - \gamma_c \mathbf{B} \cdot \hat{\mathbf{I}}^{(n)}
\right) + \Omega(t) \hat{S}_x\,,
$$ {#eq-lab-hamiltonian}

with $\Omega(t)$ given by @eq-combined-mw-field, the electronic spin energy $D \approx$ 3 GHz, the electron gyromagnetic ratio $\gamma_e =$ 2.8 MHz/G, the nuclear gyromagnetic ratio $\gamma_c =$ 1.07 kHz/G, and the hyperfine tensor $A^{(n)}$ mediating the interaction between the n-th carbon nuclear spin and the electronic spin of the NV center. The spin operators for the electronic spin are those for a spin-1 particle, with quantum numbers $(+1, 0, -1)$, cf. the $\hat{S}_z$ operator:

$$
\hat{S}_x = \frac{1}{\sqrt{2}}\begin{pmatrix}
    0 & 1 & 0 \\
    1 & 0 & 1 \\
    0 & 1 & 0
\end{pmatrix}\,,\quad
\hat{S}_y = \frac{1}{\sqrt{2}}\begin{pmatrix}
    0 & -i &  0 \\
    i &  0 & -i \\
    0 &  i &  0
\end{pmatrix}\,,\quad
\hat{S}_z = \begin{pmatrix}
    1 & 0 &   0 \\
    0 & 0 &   0 \\
    0 & 0 &  -1
\end{pmatrix}\,,\quad
ğŸ™_S = \begin{pmatrix}
    1 & 0 &  0 \\
    0 & 1 &  0 \\
    0 & 0 &  1
\end{pmatrix}\,.
$$

If were are only going to drive one of the $-1 \leftrightarrow 0$ or $0 \leftrightarrow +1$ transitions, we can simply truncate the Hilbert space by cutting the above matrices to from $3 \times 3$ to $2 \times 2$.

The nuclear spin is spin-$\frac{1}{2}$, and thus,
$$
\hat{I}_x^{(n)} = \frac{1}{2}\begin{pmatrix}
    0 & 1 \\
    1 & 0
\end{pmatrix}\,,\qquad
\hat{I}_y^{(n)} = \frac{1}{2}\begin{pmatrix}
    0 & -i \\
    i &  0
\end{pmatrix}\,,\qquad
\hat{I}_z^{(n)} = \frac{1}{2}\begin{pmatrix}
    1 &   0 \\
    0 &  -1
\end{pmatrix}\,,\qquad
ğŸ™_I^{(n)} = \begin{pmatrix}
    1 & 0 \\
    0 & 1
\end{pmatrix}\,,
$$
with eigenstates labeled $\ket{\uparrow}$ and $\ket{\downarrow}$.

The magnetic field vector is

$$
\mathbf{B} = B \begin{pmatrix}
    \sin(\theta) \cos(\phi)\\
    \sin(\theta) \sin(\phi)\\
    \cos(\theta)
    \end{pmatrix}
$$ {#eq-magnetic-field-vector}

with the azimuthal angle $\theta$, the polar angle $\phi$, and the field-strength $B$. We will assume $\theta = 0$, but there is no need to restrict a numerical model to a magnetic field not aligned with the $z$-axis defined by the NV center. In @eq-lab-hamiltonian, operators are implicitly tensored with the identity operator of all other subspaces.

## Microwave Field Rotating Wave Approximation {#sec-rwa}

To simplify the numerical model, and to remove the fast oscillations $\omega_{+}$ and $\omega_{-}$, we transform the Hamiltonian to a rotating frame and apply the rotating wave approximation (RWA). The main result of this section is @eq-rwa-hamiltonian.

The rotating frame is defined by the operator

$$
\hat{U}_{\RWA}(t)
= \diag\left[\;
\exp[i \omega_{+} t + \phi_{+}(t)], \quad
1, \quad
\exp[i \omega_{-} t + \phi_{-}(t)]
\;\right]
$$ {#eq-U-RWA}

in the electronic spin subspace. The wave function in the rotating frame is defined as $\ket{\tilde{\Psi}(t)} = \hat{U}_{\RWA}(t) \ket{\Psi(t)}$. The Hamiltonian in the rotating frame is

$$
\hat{H}_{\RWA} = i \hbar \dot{U}_{\RWA} \hat{U}_{\RWA}^\dagger + \hat{U}_{\RWA} \hat{H}_{\lab} \hat{U}_{\RWA}^\dagger
$$ {#eq-H-RWA-general}

We again have the implicit tensor product, i.e. in the full Hilbert space, @eq-H-RWA-general is more properly written with  $\hat{U}_{\RWA} \rightarrow \hat{U}_{\RWA} \otimes ğŸ™_I$. It is helpful to explicitly consider the transformation in the electronic-spin-subspace within this tensor structure. For the first term in @eq-H-RWA-general,

$$
i \hbar \left(\frac{\partial}{\partial t}(\hat{U}_{\RWA} \otimes ğŸ™_I)\right)\left(\hat{U}_{\RWA} \otimes ğŸ™_I \right)^\dagger
= (i \hbar \dot{U}_{\RWA} \hat{U}_{\RWA}^\dagger) \otimes ğŸ™_I
$$ {#eq-RWA-term1}

For the second term in @eq-H-RWA-general, we observe that @eq-lab-hamiltonian has the form

$$
\hat{H}_{\lab} = \sum_k \hat{H}_S^{(k)} \otimes \hat{H}_I^{(k)}
$$ {#eq-H-as-sum-over-k}

where $k$ simply numbers the different terms, and $\hat{H}_S^{(k)}$ and $\hat{H}_I^{(k)}$ are operators in the electronic-spin and combined-nuclear-spins subspaces. Consequently,

$$
\begin{split}
\left(\hat{U}_{\RWA} \otimes ğŸ™_I \right) \hat{H}_{\lab} \left(\hat{U}_{\RWA} \otimes ğŸ™_I \right)^\dagger
&=
\sum_k \left(\hat{U}_{\RWA} \otimes ğŸ™_I \right) \left(\hat{H}_S^{(k)} \otimes \hat{H}_I^{(k)}\right)
\left(\hat{U}_{\RWA} \otimes ğŸ™_I \right)^\dagger \\
&= \sum_k \hat{U}_{\RWA} \hat{H}_S^{(k)} \hat{U}_{\RWA}^\dagger \otimes \hat{H}_I^{(k)}
\end{split}
$${#eq-RWA-term2}

In both cases, we have made use of the distributive property of tensor and matrix products,

$$
(\hat{A} \otimes \hat{B}) (\hat{C} \otimes \hat{D})
= \hat{A} \hat{C} \otimes \hat{B}\hat{D}
$$ {#eq-tensor-distributivity}

We can now apply this to the individual operators in @eq-lab-hamiltonian, while also neglecting any fast-rotating terms $\propto \exp(\pm i \omega_{\pm}t)$ (or faster), with the resonance-condition

$$
\omega_{\pm} = D - B \gamma_e \cos(\theta) - \delta_{\pm}
\quad\Leftrightarrow\quad
\delta_{\pm} \equiv D - B \gamma_e \cos(\theta) - \omega_{\pm}\,,
$$ {#eq-resonance-condition}

introducing the detunings $\delta_{+}$ and $\delta_{-}$.

One remarkable finding that simplifies the structure of the resulting rotating wave Hamiltonian is that [@RWA_electronic_spin_system.jl]

$$
\hat{U}_{\RWA} \hat{S}_{x,y} \hat{U}_{\RWA}^\dagger
\approx 0\,,\qquad
\hat{U}_{\RWA} \hat{S}_{z} \hat{U}_{\RWA}^\dagger = \hat{S}_{z}\,,
$$ {#eq-S-in-RWA}

so that

$$
\hat{U}_{\RWA} \left( \sum_{\substack{i,j\\=x, y, z}} A^{(n)}_{i,j} (\hat{S}_i \otimes \hat{I}^{(n)}_j) \right) \hat{U}_{\RWA}^\dagger
= \sum_{\substack{j\\=x, y, z}} A_{z,j}^{(n)} \hat{S}_z \otimes \hat{I}_j^{(n)}
= \hat{S}_z \otimes \hat{A}_I^{(n)}\,,
$$ {#eq-hyperfine-RWA}

with the hyperfine-projections

$$
\hat{A}_I^{(n)}
= \sum_j A_{z,j}^{(n)} \hat{I}_j^{(n)}
= \frac{1}{2} \begin{pmatrix}
          A_{zz}^{(n)} & A_{zx}^{(n)} - i A_{zy}^{(n)} \\
    A_{zx}^{(n)} + i A_{zy}^{(n)}  &      -A_{zz}^{(n)}
\end{pmatrix}\,.
$$ {#eq-A-I-matrix}

Similarly, we can define

$$
\hat{B}_I^{(n)}
= \mathbf{B} \cdot \hat{\mathbf{I}}^{(n)}
= \frac{B}{2} \begin{pmatrix}
\cos(\theta) & \sin(\theta)\cos(\phi) - i \sin(\theta)\sin(\phi)\\
\sin(\theta)\cos(\phi) + i \sin(\theta)\sin(\phi) & -\cos(\theta)
\end{pmatrix}\,.
$$ {#eq-B-I-matrix}


Going through all the terms in @eq-lab-hamiltonian, we thus find

$$
\hat{H}_{\RWA}
= (\hat{\delta} - \hat{\omega}(t)) \otimes ğŸ™_I + \sum_{n=1}^{N} \left(\hat{S}_z \otimes \hat{A}_I^{(n)} - \gamma_c ğŸ™_S \otimes \hat{B}_I^{(n)} \right) + \hat{\Omega}(t) \otimes ğŸ™_I\,,
$$ {#eq-rwa-hamiltonian}

with

$$
\hat{\delta} = \diag\left[\delta_{+}, 0, \delta_{-}\right],\quad
\hat{\omega}(t) = \diag\left[\dot\phi_{+}(t), 0, \dot\phi_{-}(t)\right],\quad
\hat{\Omega}(t) = \frac{1}{2} \begin{pmatrix}
        0         &  \Omega_{+}(t)  &     0         \\
    \Omega_{+}(t) &      0          & \Omega_{-}(t) \\
        0         &  \Omega_{-}(t)  &      0
\end{pmatrix}\,.
$$

For the nested-list format in @eq-nested-list, this means

$$
\begin{split}
\hat{H}_{0, \RWA} & = \hat{\delta} \otimes ğŸ™_I + \sum_{n=1}^{N} \left(\hat{S}_z \otimes \hat{A}_I^{(n)} - \gamma_c ğŸ™_S \otimes \hat{B}_I^{(n)} \right) \\
\hat{H}_{\omega_{-}, \RWA} & = -\ketbra{-1}{-1} \; \otimes \; ğŸ™_I \\
\hat{H}_{\omega_{+}, \RWA} & = -\ketbra{+1}{+1} \; \otimes \; ğŸ™_I \\
\hat{H}_{\Omega_{-}, \RWA} & = \frac{1}{2} \left( \ketbra{0}{-1} + \ketbra{-1}{0} \right) \otimes ğŸ™_I \\
\hat{H}_{\Omega_{+}, \RWA} & = \frac{1}{2} \left( \ketbra{0}{+1} + \ketbra{+1}{0} \right) \otimes ğŸ™_I
\end{split}
$$ {#eq-rwa-hamiltonian-nested-list}

These operators are all in $\HilbertS \otimes \HilbertI$.

### Linear Chirp and Single Carbon

![Ground state manifold energy levels](images/levels.pdf){#fig-levels}

The energy levels are depicted in @fig-levels, for the special case of a linear chirp,

$$
\dot\phi_{\pm}(t) = \alpha_{\pm} (t - t_{\pm})\,,
$$ {#eq-linear-chirp}

a single carbon atom in the z-x plane ($A_{zy} = 0$) and the $B$ field aligned to the $z$ axis ($\theta = \phi = 0$ in @eq-magnetic-field-vector).

In explicit matrix form, the Hamiltonian for this special case in
the subspace including the electronic spin $0$ and the $+1$ subspace is @AjoySA2018_Hamiltonian.jl

$$
\hat{H}_{\RWA, +} = \begin{pmatrix}
    \frac{A_{zz}}{2} - \frac{B \gamma_c}{2} - \alpha_{+}(t - t_{+}) + \delta_{+} & \frac{A_{zx}}{2} & \frac{\Omega_{+}(t)}{2} & 0 \\
    \frac{A_{zx}}{2} & -\frac{A_{zz}}{2} + \frac{B \gamma_c}{2} - \alpha_{+} (t - t_{+}) + \delta_{+} & 0 & \frac{\Omega_{+}(t)}{2} \\
    \frac{\Omega_{+}(t)}{2} & 0 & -\frac{B \gamma_c}{2} & 0 \\
    0 & \frac{\Omega_{+}(t)}{2} & 0 & \frac{B \gamma_c}{2}
\end{pmatrix}\,,
$$ {#eq-hamiltonian-rwa-matrix-plus}

and, in the subspace with electronic spin $0$ and $-1$,

$$
\hat{H}_{\RWA, -} = \begin{pmatrix}
    -\frac{B \gamma_c}{2} & 0 & \frac{\Omega_{-}(t)}{2} & 0\\
    0 & \frac{B \gamma_c}{2} & 0 & \frac{\Omega_{-}(t)}{2} \\
    \frac{\Omega_{-}(t)}{2} & 0 & - \frac{A_{zz}}{2} - \frac{B \gamma_c}{2} - \alpha_{-}(t - t_{-}) + \delta_{-} & \frac{A_{zx}}{2} \\
    0 & \frac{\Omega_{-}(t)}{2} & -\frac{A_{zx}}{2} & \frac{A_{zz}}{2} + \frac{B \gamma_c}{2} - \alpha_{-} (t - t_{-}) + \delta_{-} \\
\end{pmatrix}\,.
$$ {#eq-hamiltonian-rwa-matrix-minus}

Note the  off-resonant Rabi-cycling in the $\ket{\pm 1}$ manifolds, cf. also @eq-A-I-matrix.


## Diagonalizing the Hyperfine Interaction {#sec-diag}

We can further simplify the Hamiltonian by diagonalizing the projection of the hyperfine matrix into the nuclear-spin subspace, @eq-A-I-matrix. We note that $\hat{A}_I^{(n)}$ is Hermitian, and thus real-valued eigenvalues and a unitary transformation operator $\hat{R}^{(n)}$ so that

$$
\hat{A}_I^{(n)}
= \hat{R}^{(n)}
    \begin{pmatrix}
    \lambda_{+} & 0 \\ 0 & \lambda_{-}
  \end{pmatrix}
  \hat{R}^{(n)\dagger}
$$ {#eq-eigendecomposition}

This eigendecomposition can be solved analytically [@DiagonalizeHyperfine.jl] with

$$
\lambda_{\pm} = \frac{\tr(\hat{A}_I^{(n)})}{2} \pm \sqrt{\frac{\tr^2(\hat{A}_I^{(n)})}{4} - \det(\hat{A}_I^{(n)})}
$$ {#eq-analytical-eigenvalues}

We can see that

$$
\tr(\hat{A}_I^{(n)}) = 0, \qquad
\det(\hat{A}_I^{(n)}) = -\frac{1}{4} {A^{(n)}}^2\,,
$$

with the overall hyperfine magnitude

$$
A^{(n)} \equiv \sqrt{{A_{zz}^{(n)}}^2 + {A_{zx}^{(n)}}^2 + {A_{zy}^{(n)}}^2}\,.
$$ {#eq-A}

Thus, we have

$$
\lambda_{\pm} = \pm A / 2
$$ {#eq-lambda}

and

$$
\hat{A}_I^{(n)} = A \, \hat{R}^{(n)} \hat{I}_z^{(n)} \hat{R}^{(n)\dagger}
$$ {#eq-eigendecomposition-A}

For $R^{(n)}$, with proper normalization ($R^{(n)} {R^{(n)}}^{\dagger} = ğŸ™_I^{(n)}$), we find (temporarily dropping the superscript $(n)$ on the right-hand-side):

$$
\hat{R}^{(n)} = \frac{1}{\sqrt{2}} \begin{pmatrix}
	\frac{A_{zz} + A}{\sqrt{A^2 + A A_{zz}}} & \frac{A_{zz} - A}{\sqrt{A^2 - A A_{zz}}} \\
	\frac{A_{zx} + i A_{zy}}{\sqrt{A^2 + A A_{zz}}} & \frac{A_{zx} + i A_{zy}}{\sqrt{A^2 - A A_{zz}}}
\end{pmatrix}
$$ {#eq-R}

For the total Hamiltonian, we can now define a diagonal frame via the unitary

$$
\hat{R} = \hat{R}^{(1)} \otimes \dots \otimes \hat{R}^{(N)}\,.
$$ {#eq-R-total}

The Hamiltonian in this diagonal frame is

$$
\begin{split}
\hat{H}_{\diag}
& = \hat{R}^\dagger \hat{H}_{\RWA} \hat{R} \\
& = (\hat{\delta} - \hat{\omega}(t)) \otimes ğŸ™_I + \sum_{n=1}^{N} \left(A^{(n)} \hat{S}_z \otimes \hat{I}_z^{(n)} - \gamma_c ğŸ™_S \otimes \hat{B}_I^{(n)} \right) + \hat{\Omega}(t) \otimes ğŸ™_I\,,
\end{split}
$$ {#eq-hamiltonian-diagonal}

with $\hat{B}_I^{(n)}$ defined in @eq-B-I-matrix. Any wave function $\ket{\tilde{\Psi}(t)}$ in the rotating frame is transformed into the diagonal frame as $\ket{\Psi(t)} = \hat{R}^\dagger \ket{\tilde{\Psi}(t)}$. Note the dagger, as we have used the common notation for the eigendecomposition in @eq-eigendecomposition, which is the opposite from the notation used for the rotating frame, cf. @eq-H-RWA-general. The transformation affects the relative population in the nuclear spins. In the diagonal frame, after $\Omega(t)$ has been switched off, the populations remain stable (since the Hamiltonian is diagonal). In contrast, in the lab/rotating frame, we would be seeing indefinite off-resonant Rabi-cycling in the $\ket{\pm 1}$ manifolds. The transformation $\hat{R}$ precisely restores the superposition due to this Rabi cycling.

For the nested-list format in @eq-nested-list, this means

$$
\hat{H}_{0, \diag} =  \hat{\delta} \otimes ğŸ™_I + \sum_{n=1}^{N} \left(A^{(n)} \hat{S}_z \otimes \hat{I}_z^{(n)} - \gamma_c ğŸ™_S \otimes \hat{B}_I^{(n)} \right)
$$ {#eq-hamiltonian-diagonal-nested-list}

and $\hat{H}_{\omega_{-}, \diag}$ $\hat{H}_{\omega_{+}, \diag}$ $\hat{H}_{\Omega_{-}, \diag}$ $\hat{H}_{\Omega_{+}, \diag}$ as in @eq-rwa-hamiltonian-nested-list; all operators in $\HilbertS \otimes \HilbertI$. The only difference between the rotating frame Hamiltonian in @eq-rwa-hamiltonian and the diagonal frame Hamiltonian is the term $\hat{S}_z \otimes \hat{A}_I^{(n)}$ in @eq-rwa-hamiltonian and @eq-rwa-hamiltonian-nested-list being replaced with $A^{(n)} \hat{S}_z \otimes \hat{I}_z^{(n)}$ in @eq-hamiltonian-diagonal and @eq-hamiltonian-diagonal-nested-list.


### Linear Chirp and Single Carbon

As we did in the rotating frame in @eq-hamiltonian-rwa-matrix-plus and @eq-hamiltonian-rwa-matrix-minus, we can again write out the Hamiltonian for the $0/+1$ and $0/-1$ manifolds under the assumption of a single nuclear spin and a linear chirp.

$$
\hat{H}_{\RWA, +} = \begin{pmatrix}
    \frac{A}{2} - \frac{B \gamma_c}{2} - \alpha_{+}(t - t_{+}) + \delta_{+} &         0        & \frac{\Omega_{+}(t)}{2} & 0 \\
            0        & -\frac{A}{2} + \frac{B \gamma_c}{2} - \alpha_{+} (t - t_{+}) + \delta_{+} & 0 & \frac{\Omega_{+}(t)}{2} \\
    \frac{\Omega_{+}(t)}{2} & 0 & -\frac{B \gamma_c}{2} & 0 \\
    0 & \frac{\Omega_{+}(t)}{2} & 0 & \frac{B \gamma_c}{2}
\end{pmatrix}\,,
$$ {#eq-hamiltonian-diag-matrix-plus}

$$
\hat{H}_{\RWA, -} = \begin{pmatrix}
    -\frac{B \gamma_c}{2} & 0 & \frac{\Omega_{-}(t)}{2} & 0\\
    0 & \frac{B \gamma_c}{2} & 0 & \frac{\Omega_{-}(t)}{2} \\
    \frac{\Omega_{-}(t)}{2} & 0 & - \frac{A}{2} - \frac{B \gamma_c}{2} - \alpha_{-}(t - t_{-}) + \delta_{-} &        0         \\
    0 & \frac{\Omega_{-}(t)}{2} &         0         & \frac{A}{2} + \frac{B \gamma_c}{2} - \alpha_{-} (t - t_{-}) + \delta_{-} \\
\end{pmatrix}\,,
$$ {#eq-hamiltonian-diag-matrix-minus}

with the $A$ given in @eq-A.

## Mapping between Electronic and Nuclear Spins via Landau-Zener Crossings {#sec-lz}

TODO

After a Landau-Zener transition the probability of population transfer is [@LandauZener.jl]

$$
P_{LZ} = \exp\left(-2 \pi \frac{\vert\Omega\vert^2}{\vert\alpha\vert^2} \right)
$$ {#eq-lz-probability}

## Dissipators for the Excited and Metastable Manifolds {#sec-dissipation}

![Level scheme of the combined optical-electronic subspace](images/liouville_levels.pdf){#fig-liouville-levels}

The optical laser field $\Lambda(t)$ enables incoherent transitions between the ground state $\ket{G}$ manifold described above, and the excited state manifold $\ket{E}$. We also have a decay channel from $\ket{E}$ to $\ket{G}$ via the metastable state $\ket{M}$ (frequently also indicated as $\ket{S}$ in the literature, but this might cause confusion), as depicted in @fig-liouville-levels.

The dynamics are described by a master equation in Lindblad form with the following Lindblad operators:

* $\hat{A}_{\Lambda} = \sqrt{\Lambda(t)} \ketbra{E}{G} \otimes ğŸ™_S \otimes ğŸ™_I \,\oplus\, ğŸ˜_M \otimes ğŸ™_I$
* $\hat{A}_{\Gamma} = \sqrt{\Gamma}\ketbra{G}{E} \otimes ğŸ™_S \otimes ğŸ™_I \,\oplus\, ğŸ˜_M \otimes ğŸ™_I$

where $\ketbra{E}{G}$ and $\ketbra{G}{E}$ are operators in the two-dimensional Hilbert space $\HilbertG \oplus \HilbertE$, cf. the second line in @eq-Hilbert-space-structure. The first of the two Lindblad operators above describes the somewhat unusual _incoherent_ excitation of the $\ket{E}$ manifold. The time-dependent $\Lambda(t)$ is not directly supported by the `QuantumControl.liouvillian` function. Instead, we construct a super-operator [@Goerz1312.0111v2, Appendix B.2]

$$
L = (\hat{A}^\dagger)^T \otimes \hat{A} - \frac{1}{2} \left(ğŸ™ \otimes \hat{A}^\dagger \hat{A}\right) - \frac{1}{2} \left((\hat{A}^\dagger \hat{A})^T \otimes ğŸ™\right)\,,
$$ {#eq-dissipation-superop}

with $\hat{A}$ the operator $\hat{A}_{\Lambda}$ for $\sqrt{\Lambda(t)} = 1$ (i.e., without the rate factor). This is done by calling the `QuantumControl.liouvillian` function with `nothing` as the Hamiltonian and $\hat{A}$ as the only element in `c_ops`. The resulting $L$ is then added with a drive $\Lambda(t)$ to the Liouvillian super-operator initialized automatically via the `QuantumControl.liouvillian` function from the coherent Hamiltonian previously constructed, the dissipator $\hat{A}_{\Gamma}$, and the following further dissipators:

* $\hat{A}_{\Gamma_{0}} = \sqrt{\Gamma_{0}}\ketbra{M}{E,0} \otimes ğŸ™_I$
* $\hat{A}_{\Gamma_{-1}} = \sqrt{\Gamma_{-1}}\ketbra{M}{E,-1} \otimes ğŸ™_I$
* $\hat{A}_{\Gamma_{+1}} = \sqrt{\Gamma_{+1}}\ketbra{M}{E,+1} \otimes ğŸ™_I$

* $\hat{A}_{\Sigma_{0}} = \sqrt{\Sigma_{0}}\ketbra{G,0}{M} \otimes ğŸ™_I$
* $\hat{A}_{\Sigma_{-1}} = \sqrt{\Sigma_{-1}}\ketbra{G,-1}{M} \otimes ğŸ™_I$
* $\hat{A}_{\Sigma_{+1}} = \sqrt{\Sigma_{+1}}\ketbra{G,+1}{M} \otimes ğŸ™_I$

* $\hat{A}_{\gamma_{+1}} = \sqrt{\gamma_{+1}}\ketbra{G,0}{G,+1} \otimes ğŸ™_I$
* $\hat{A}_{\gamma_{-1}} = \sqrt{\gamma_{-1}}\ketbra{G,0}{G,-1} \otimes ğŸ™_I$

The last two operators are under the assumption that spontaneous decay of the electronic spin occurs only in the $\ket{G}$ manifold, as indicated in @fig-liouville-levels; if that decay also occurred in the $\ket{E}$ manifold, the corresponding terms $\ketbra{E,0}{E,\pm1}$ would have to be added to $\hat{A}_{\gamma_{\pm1}}$. All of the above decay operators follow the structure of the third line in @eq-Hilbert-space-structure.


## References

::: {#refs}
:::
